"use strict";

// src/workers/sig-verification.ts
var import_secp256k1 = require("@noble/curves/secp256k1");
var import_sha256 = require("@noble/hashes/sha256");
var import_utils = require("@noble/hashes/utils");
globalThis.onmessage = (msg) => {
  const { serialized, id, sig, pubkey } = msg.data;
  queueMicrotask(() => {
    const eventHash = (0, import_sha256.sha256)(new TextEncoder().encode(serialized));
    const hash = (0, import_utils.bytesToHex)(eventHash);
    if (hash !== id) {
      postMessage([id, false]);
      return;
    }
    const result = import_secp256k1.schnorr.verify(sig, hash, pubkey);
    postMessage([id, result]);
  });
};
